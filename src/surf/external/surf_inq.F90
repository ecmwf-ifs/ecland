SUBROUTINE SURF_INQ(YDSURF,&
                  & KNVTYPES,KNSOTY,PRRCSOIL,PRWSAT,PRWCAP,PRWPWP,PRQWEVAP,PRQWSBCR,&
                  & PRQSNCR,PRWLMAX,PRWSATM,PRWCAPM,PRWPWPM,PRTF1,PRTF2,PRTF3,PRTF4,&
                  & PRTFREEZSICE,PRTMELTSICE,PRCIMIN,PRALFMINSN,&
                  & PRALFMAXSN,PRHOMINSN,PRHOMAXSN,PRHOMINSND,PRHOMAXSN_NEW,PRDAT,&
                  & PRDAW,PRRCSICE,PRALBSEAD,PREPALB,PRVCOV,PRVLAI,PRVRSMIN,&
                  & PRDAT_4,PRDAW_4,&
                  & PRVROOTSA,PRVLAMSK,PRVLAMSKS,PRVTRSR,PRNU,PRNUM,PRNUH,PRNUQ,PRCHAR,PREPUST,&
                  & PRDSCALE_KPP,PRVC_KPP,PRVD_KPP,PRVE_KPP,PRVDEL_KPP,LDVL_NEW_KPP,&
                  & LD_LESNML, RLEVSNMIN, RLEVSNMAX,&
                  & RLEVSNMIN_GL, RLEVSNMAX_GL)

! (C) Copyright 2001- ECMWF.
!
! This software is licensed under the terms of the Apache Licence Version 2.0
! which can be obtained at http://www.apache.org/licenses/LICENSE-2.0.
! In applying this licence, ECMWF does not waive the privileges and immunities
! granted to it by virtue of its status as an intergovernmental organisation
! nor does it submit to any jurisdiction.
!**   *SURF_INQ*  Extract information from the surface package

!     Purpose.
!     --------
!     Interface routine for extracting information from the surf pack.

!**   Interface.
!     ----------
!     CALL SURF_INQ(...)
!     Explicit arguments : All arguments are optional.
!     --------------------

!     Method.
!     -------

!     Externals: none

!     Author.
!     -------
!        JF Estrade *ECMWF*

!     Modifications.
!     --------------
!        Original : 03-10-01
!        M.Hamrud      01-Oct-2003 CY28 Cleaning
!        G.Balsamo     01-Sep-2006 Add soil type related information
!I. Sandu    24-02-2014  Lambda skin values by vegetation type instead of tile
!        R. El Khatib 09-Sep-2016 PRVRSMIN
!     ------------------------------------------------------------------

USE PARKIND1, ONLY : JPIM, JPRB
USE ISO_C_BINDING

!ifndef INTERFACE

USE YOMHOOK,  ONLY : LHOOK, DR_HOOK, JPHOOK
USE YOS_SURF, ONLY : TSURF, GET_SURF
USE ABORT_SURF_MOD

!endif INTERFACE

IMPLICIT NONE

! Declaration of arguments

TYPE(C_PTR),                  INTENT(IN)  :: YDSURF
INTEGER(KIND=JPIM) ,OPTIONAL, INTENT(OUT) :: KNSOTY
INTEGER(KIND=JPIM) ,OPTIONAL, INTENT(OUT) :: KNVTYPES
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRRCSOIL
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWSAT
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRQWSBCR
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWCAP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWPWP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRQWEVAP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRQSNCR
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWLMAX
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWSATM(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWCAPM(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRWPWPM(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTFREEZSICE
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTMELTSICE
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRCIMIN
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRALFMINSN
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRALFMAXSN
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRHOMINSN
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRHOMAXSN
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRHOMINSND
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRHOMAXSN_NEW
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRDAT(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRDAW(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRDAT_4(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRDAW_4(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRALBSEAD
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PREPALB
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVCOV(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVLAI(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVRSMIN(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRNU
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRNUM
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRNUH
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRNUQ
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRCHAR
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PREPUST
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTF1
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTF2
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTF3
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRTF4
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRRCSICE
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVROOTSA(:,0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVLAMSK(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVLAMSKS(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVTRSR(0:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRDSCALE_KPP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVC_KPP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVD_KPP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVE_KPP
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: PRVDEL_KPP
LOGICAL            ,OPTIONAL, INTENT(OUT) :: LDVL_NEW_KPP
LOGICAL            ,OPTIONAL, INTENT(OUT) :: LD_LESNML
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: RLEVSNMIN(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: RLEVSNMAX(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: RLEVSNMIN_GL(:)
REAL(KIND=JPRB)    ,OPTIONAL, INTENT(OUT) :: RLEVSNMAX_GL(:)

!ifndef INTERFACE

INTEGER(KIND=JPIM) :: JK, JTYP
TYPE(TSURF), POINTER :: YSURF
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK('SURF_INQ',0,ZHOOK_HANDLE)

YSURF => GET_SURF(YDSURF)

ASSOCIATE(YDIM=>YSURF%YDIM, YEXC=>YSURF%YEXC, YOCEAN_ML=>YSURF%YOCEAN_ML, &
 & YRDI=>YSURF%YRDI, YSOIL=>YSURF%YSOIL, YVEG=>YSURF%YVEG)

IF(PRESENT(KNSOTY))    KNSOTY=YSOIL%NSOTY
IF(PRESENT(KNVTYPES))  KNVTYPES=YVEG%NVTYPES
IF(PRESENT(PRRCSOIL))  PRRCSOIL=YSOIL%RRCSOIL
IF(PRESENT(PRWSAT))    PRWSAT=YSOIL%RWSAT
IF(PRESENT(PRWCAP))    PRWCAP=YSOIL%RWCAP
IF(PRESENT(PRWPWP))    PRWPWP=YSOIL%RWPWP
IF(PRESENT(PRQWEVAP))  PRQWEVAP=YSOIL%RQWEVAP
IF(PRESENT(PRQWSBCR))  PRQWSBCR=YSOIL%RQWSBCR
IF(PRESENT(PRQSNCR))   PRQSNCR=YSOIL%RQSNCR
IF(PRESENT(PRWLMAX))   PRWLMAX=YSOIL%RWLMAX

IF(PRESENT(PRWSATM)) THEN
  IF(UBOUND(PRWSATM,1) < YSOIL%NSOTY) THEN
    CALL ABORT_SURF('SURF_INQ: PRWSATM TOO SMALL')
  ELSE
    DO JTYP=0,YSOIL%NSOTY
      PRWSATM(JTYP)=YSOIL%RWSATM(JTYP)
    ENDDO
  ENDIF
ENDIF
IF(PRESENT(PRWCAPM)) THEN
  IF(UBOUND(PRWCAPM,1) < YSOIL%NSOTY) THEN
    CALL ABORT_SURF('SURF_INQ: PRWCAPM TOO SMALL')
  ELSE
    DO JTYP=0,YSOIL%NSOTY
      PRWCAPM(JTYP)=YSOIL%RWCAPM(JTYP)
    ENDDO
  ENDIF
ENDIF
IF(PRESENT(PRWPWPM)) THEN
  IF(UBOUND(PRWPWPM,1) < YSOIL%NSOTY) THEN
    CALL ABORT_SURF('SURF_INQ: PRWPWPM TOO SMALL')
  ELSE
    DO JTYP=0,YSOIL%NSOTY
      PRWPWPM(JTYP)=YSOIL%RWPWPM(JTYP)
    ENDDO
  ENDIF
ENDIF



IF(PRESENT(PRTF1))  PRTF1=YSOIL%RTF1
IF(PRESENT(PRTF2))  PRTF2=YSOIL%RTF2
IF(PRESENT(PRTF3))  PRTF3=YSOIL%RTF3
IF(PRESENT(PRTF4))  PRTF4=YSOIL%RTF4
IF(PRESENT(PRTFREEZSICE))  PRTFREEZSICE=YSOIL%RTFREEZSICE
IF(PRESENT(PRTMELTSICE))  PRTMELTSICE=YSOIL%RTMELTSICE
IF(PRESENT(PRCIMIN))  PRCIMIN=YSOIL%RCIMIN
IF(PRESENT(PRALFMINSN))  PRALFMINSN=YSOIL%RALFMINSN
IF(PRESENT(PRALFMAXSN))  PRALFMAXSN=YSOIL%RALFMAXSN
IF(PRESENT(PRHOMINSN))  PRHOMINSN=YSOIL%RHOMINSN
IF(PRESENT(PRHOMAXSN))  PRHOMAXSN=YSOIL%RHOMAXSN
IF(PRESENT(PRHOMINSND))     PRHOMINSND=YSOIL%RHOMINSND
IF(PRESENT(PRHOMAXSN_NEW))  PRHOMAXSN_NEW=YSOIL%RHOMAXSN_NEW
IF(PRESENT(PRRCSICE))  PRRCSICE=YSOIL%RRCSICE
IF(PRESENT(PRALBSEAD)) PRALBSEAD=YRDI%RALBSEAD
IF(PRESENT(PREPALB)) PREPALB=YRDI%REPALB
IF(PRESENT(PRNU)) PRNU=YEXC%RNU
IF(PRESENT(PRNUM)) PRNUM=YEXC%RNUM
IF(PRESENT(PRNUH)) PRNUH=YEXC%RNUH
IF(PRESENT(PRNUQ)) PRNUQ=YEXC%RNUQ
IF(PRESENT(PRCHAR)) PRCHAR=YEXC%RCHAR
IF(PRESENT(PREPUST)) PREPUST=YEXC%REPUST
IF(PRESENT(LD_LESNML)) LD_LESNML=YSOIL%LESNML

IF(PRESENT(PRDAT)) THEN
  IF(UBOUND(PRDAT,1) < YDIM%NCSS) THEN
    CALL ABORT_SURF('SURF_INQ: PRDAT TOO SMALL')
  ELSE
    DO JK=1,YDIM%NCSS
      PRDAT(JK)=YSOIL%RDAT(JK)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(PRDAW)) THEN
  IF(UBOUND(PRDAW,1) < YDIM%NCSS) THEN
    CALL ABORT_SURF('SURF_INQ: PRDAW TOO SMALL')
  ELSE
    DO JK=1,YDIM%NCSS
      PRDAW(JK)=YSOIL%RDAW(JK)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(PRDAW_4)) THEN
  IF(UBOUND(PRDAW_4,1) < 4) THEN
    CALL ABORT_SURF('SURF_INQ: PRDAW_4 TOO SMALL')
  ELSE
      PRDAW_4(1:4)=(/0.07,0.21,0.72,1.89/)
  ENDIF
ENDIF

IF(PRESENT(PRDAT_4)) THEN
  IF(UBOUND(PRDAT_4,1) < 4) THEN
    CALL ABORT_SURF('SURF_INQ: PRDAT_4 TOO SMALL')
  ELSE
      PRDAT_4(1:4)=(/0.07,0.21,0.72,1.89/)
  ENDIF
ENDIF

IF(PRESENT(PRVCOV)) THEN
  IF(UBOUND(PRVCOV,1) < YVEG%NVTYPES) THEN
    CALL ABORT_SURF('SURF_INQ: PRVCOV TOO SMALL')
  ELSE
    DO JTYP=0,YVEG%NVTYPES
      PRVCOV(JTYP)=YVEG%RVCOV(JTYP)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(PRVLAI)) THEN
  IF(UBOUND(PRVLAI,1) < YVEG%NVTYPES) THEN
    CALL ABORT_SURF('SURF_INQ: PRVLAI TOO SMALL')
  ELSE
    DO JTYP=0,YVEG%NVTYPES
      PRVLAI(JTYP)=YVEG%RVLAI(JTYP)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(PRVRSMIN)) THEN
  IF(UBOUND(PRVRSMIN,1) < YVEG%NVTYPES) THEN
    CALL ABORT_SURF('SURF_INQ: PRVRSMIN TOO SMALL')
  ELSE
    DO JTYP=0,YVEG%NVTYPES
      PRVRSMIN(JTYP)=YVEG%RVRSMIN(JTYP)
    ENDDO
  ENDIF
ENDIF

 IF(PRESENT(PRVROOTSA)) THEN
   IF(UBOUND(PRVROOTSA,1) < YDIM%NCSS) THEN
     CALL ABORT_SURF('SURF_INQ: 1ST DIMENSION OF PRVROOTSA TOO SMALL')
   ELSE IF (UBOUND(PRVROOTSA,2) < YVEG%NVTYPES) THEN
     CALL ABORT_SURF('SURF_INQ: 2ND DIMENSION OF PRVROOTSA TOO SMALL')
   ELSE
     DO JTYP=0,YVEG%NVTYPES
       DO JK=1,YDIM%NCSS
         PRVROOTSA(JK,JTYP)=YVEG%RVROOTSA(JK,JTYP)
       ENDDO
     ENDDO
   ENDIF
 ENDIF

 IF(PRESENT(PRVLAMSK)) THEN
   IF(UBOUND(PRVLAMSK,1) < YVEG%NVTYPES) THEN
     CALL ABORT_SURF('SURF_INQ: PRVLAMSK TOO SMALL')
   ELSE
     DO JTYP=0,YVEG%NVTYPES
       PRVLAMSK(JTYP)=YVEG%RVLAMSK(JTYP)
     ENDDO
   ENDIF
 ENDIF

 IF(PRESENT(PRVLAMSKS)) THEN
   IF(UBOUND(PRVLAMSKS,1) < YVEG%NVTYPES) THEN
     CALL ABORT_SURF('SURF_INQ: PRVLAMSKS TOO SMALL')
   ELSE
     DO JTYP=0,YVEG%NVTYPES
       PRVLAMSKS(JTYP)=YVEG%RVLAMSKS(JTYP)
     ENDDO
   ENDIF
 ENDIF

 IF(PRESENT(PRVTRSR)) THEN
   IF(UBOUND(PRVTRSR,1) < YVEG%NVTYPES) THEN
     CALL ABORT_SURF('SURF_INQ: PRVTRSR TOO SMALL')
   ELSE
     DO JTYP=0,YVEG%NVTYPES
       PRVTRSR(JTYP)=YVEG%RVTRSR(JTYP)
     ENDDO
   ENDIF
 ENDIF

IF(PRESENT(RLEVSNMIN)) THEN
  IF(UBOUND(RLEVSNMIN,1) < YSOIL%NLEVSN) THEN
    CALL ABORT_SURF('SURF_INQ: RLEVSNMIN TOO SMALL')
  ELSE
    DO JK=1,YSOIL%NLEVSN
      RLEVSNMIN(JK)=YSOIL%RLEVSNMIN(JK)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(RLEVSNMAX)) THEN
  IF(UBOUND(RLEVSNMAX,1) < YSOIL%NLEVSN) THEN
    CALL ABORT_SURF('SURF_INQ: RLEVSNMAX TOO SMALL')
  ELSE
    DO JK=1,YSOIL%NLEVSN
      RLEVSNMAX(JK)=YSOIL%RLEVSNMAX(JK)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(RLEVSNMIN_GL)) THEN
  IF(UBOUND(RLEVSNMIN_GL,1) < YSOIL%NLEVSN) THEN
    CALL ABORT_SURF('SURF_INQ: RLEVSNMIN_GL TOO SMALL')
  ELSE
    DO JK=1,YSOIL%NLEVSN
      RLEVSNMIN_GL(JK)=YSOIL%RLEVSNMIN_GL(JK)
    ENDDO
  ENDIF
ENDIF

IF(PRESENT(RLEVSNMAX_GL)) THEN
  IF(UBOUND(RLEVSNMAX_GL,1) < YSOIL%NLEVSN) THEN
    CALL ABORT_SURF('SURF_INQ: RLEVSNMAX_GL TOO SMALL')
  ELSE
    DO JK=1,YSOIL%NLEVSN
      RLEVSNMAX_GL(JK)=YSOIL%RLEVSNMAX_GL(JK)
    ENDDO
  ENDIF
ENDIF


IF(PRESENT(PRDSCALE_KPP)) PRDSCALE_KPP = YOCEAN_ML%RDSCALE_KPP
IF(PRESENT(PRVC_KPP))     PRVC_KPP     = YOCEAN_ML%RVC_KPP
IF(PRESENT(PRVD_KPP))     PRVD_KPP     = YOCEAN_ML%RVD_KPP
IF(PRESENT(PRVE_KPP))     PRVE_KPP     = YOCEAN_ML%RVE_KPP
IF(PRESENT(PRVDEL_KPP))   PRVDEL_KPP   = YOCEAN_ML%RVDEL_KPP
IF(PRESENT(LDVL_NEW_KPP)) LDVL_NEW_KPP = YOCEAN_ML%LVL_NEW_KPP

END ASSOCIATE
IF (LHOOK) CALL DR_HOOK('SURF_INQ',1,ZHOOK_HANDLE)

!endif INTERFACE

!     ------------------------------------------------------------------

END SUBROUTINE SURF_INQ
